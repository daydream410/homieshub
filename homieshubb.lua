bG9jYWwgUmF5ZmllbGQgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgnaHR0cHM6Ly9zaXJpdXMubWVudS9yYXlmaWVsZCcpKSgpCgpsb2NhbCB0YXJnZXRHYW1lSUQgPSAyNjkzMDIzMzE5ICAtLSBHYW50aSBkZW5nYW4gSUQgZ2FtZSB5YW5nIHNlc3VhaQoKLS0gTWVuZGFwYXRrYW4gSUQgZ2FtZSBzYWF0IGluaQpsb2NhbCBjdXJyZW50R2FtZUlEID0gZ2FtZS5QbGFjZUlkCgotLSBNZW5nZWNlayBhcGFrYWggZ2FtZSBJRCBjb2NvawppZiBjdXJyZW50R2FtZUlEID09IHRhcmdldEdhbWVJRCB0aGVuCiAgICAtLSBTa3JpcCBoYW55YSBha2FuIGRpamFsYW5rYW4gamlrYSBnYW1lIElEIGNvY29rCiAgICBnYW1lLlN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICBUaXRsZSA9ICJHYW1lIENoZWNrIiwKICAgICAgICBUZXh0ID0gIkNPUlJFQ1QgR0FNRSEiLAogICAgICAgIER1cmF0aW9uID0gNQogICAgfSkKICAgIC0tIE1lbnVuZ2d1IDUgZGV0aWsgYWdhciBub3RpZmlrYXNpICJHYW1lIENoZWNrIiBtdW5jdWwKICAgIHRhc2sud2FpdCg1KQoKICAgbG9jYWwgV2luZG93ID0gUmF5ZmllbGQ6Q3JlYXRlV2luZG93KHsKICAgTmFtZSA9ICJIb21pZXMgSHViIiwKICAgTG9hZGluZ1RpdGxlID0gIkFwYSBrZWsgdWRhaCBnZWRlIiwKICAgTG9hZGluZ1N1YnRpdGxlID0gImJ5IHl1Z2llb29oIiwKICAgQ29uZmlndXJhdGlvblNhdmluZyA9IHsKICAgICAgRW5hYmxlZCA9IHRydWUsCiAgICAgIEZvbGRlck5hbWUgPSAiaG9taWVzIiwKICAgICAgRmlsZU5hbWUgPSAiSG9taWVzIEh1YiIKICAgfSwKICAgIERpc2NvcmQgPSB7CiAgICAgIEVuYWJsZWQgPSB0cnVlLCAtLSBQcm9tcHQgdGhlIHVzZXIgdG8gam9pbiB5b3VyIERpc2NvcmQgc2VydmVyIGlmIHRoZWlyIGV4ZWN1dG9yIHN1cHBvcnRzIGl0CiAgICAgIEludml0ZSA9ICJXTU5QU3dLZ1E4IiwgLS0gVGhlIERpc2NvcmQgaW52aXRlIGNvZGUsIGRvIG5vdCBpbmNsdWRlIGRpc2NvcmQuZ2cvLiBFLmcuIGRpc2NvcmQuZ2cvIEFCQ0Qgd291bGQgYmUgQUJDRAogICAgICBSZW1lbWJlckpvaW5zID0gZmFsc2UgLS0gU2V0IHRoaXMgdG8gZmFsc2UgdG8gbWFrZSB0aGVtIGpvaW4gdGhlIGRpc2NvcmQgZXZlcnkgdGltZSB0aGV5IGxvYWQgaXQgdXAKICAgfSwKICAgS2V5U3lzdGVtID0gdHJ1ZSwKICAgS2V5U2V0dGluZ3MgPSB7CiAgICAgIFRpdGxlID0gIktleSB8IEhvbWllcyBIdWIiLAogICAgICBTdWJ0aXRsZSA9ICJLZXkgU3lzdGVtIiwKICAgICAgTm90ZSA9ICJLZXkgSW4gRGlzY29yZCBTZXJ2ZXIiLAogICAgICBGaWxlTmFtZSA9ICJIb21pZXNIdWJLZXkxIiwKICAgICAgU2F2ZUtleSA9IGZhbHNlLAogICAgICBHcmFiS2V5RnJvbVNpdGUgPSBmYWxzZSwKICAgIC0tICAgR3JhYktleUZyb21TaXRlID0gdHJ1ZSwKICAgICAgS2V5ID0geyJob21pZXMifQogICAgLS0gICBLZXkgPSB7Imh0dHBzOi8vcGFzdGViaW4uY29tL3Jhdy9BdGd6U1BXSyJ9CiAgIH0KfSkKCmxvY2FsIE1haW5UYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCLwn4-gIiwgbmlsKQpsb2NhbCBNYWluU2VjdGlvbiA9IE1haW5UYWI6Q3JlYXRlU2VjdGlvbigiTWFpbiIpCgpSYXlmaWVsZDpOb3RpZnkoewogICBUaXRsZSA9ICJIb21pZXMgSHViIFNjcmlwdCIsCiAgIENvbnRlbnQgPSAiQnkgeXVnaWVvb2giLAogICBEdXJhdGlvbiA9IDUsCiAgIEltYWdlID0gMTMwNDc3MTUxNzgsCiAgIEFjdGlvbnMgPSB7CiAgICAgIElnbm9yZSA9IHsKICAgICAgICAgTmFtZSA9ICJPa2F5ISIsCiAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICBlbmQKICAgICAgfQogICB9LAp9KQoKLS0gSW5maW5pdGUgSnVtcCBUb2dnbGUKbG9jYWwgaW5maW5pdGVKdW1wVG9nZ2xlID0gTWFpblRhYjpDcmVhdGVUb2dnbGUoewogICBOYW1lID0gIkluZmluaXRlIEp1bXAgKEZhbGwgRGFtYWdlKSIsCiAgIEN1cnJlbnRWYWx1ZSA9IGZhbHNlLAogICBGbGFnID0gIkluZkp1bXBGbGFnIiwKICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgIC0tIE1lbmdhdHVyIF9HLmluZmluanVtcCBiZXJkYXNhcmthbiBuaWxhaSBWYWx1ZSBkYXJpIHRvZ2dsZQogICAgICAgX0cuaW5maW5qdW1wID0gVmFsdWUKCiAgICAgICAtLSBGdW5nc2kgdW50dWsgbWVuZ2F0dXIgSW5maW5pdGUgSnVtcCBwYWRhIGthcmFrdGVyIHBlbWFpbgogICAgICAgbG9jYWwgZnVuY3Rpb24gc2V0dXBJbmZpbml0ZUp1bXAoY2hhcmFjdGVyKQogICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgIGxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoJ1VzZXJJbnB1dFNlcnZpY2UnKQoKICAgICAgICAgICAtLSBNZW5naHVidW5na2FuIGV2ZW50IHVudHVrIG1lbmRldGVrc2kga2V0aWthIHBlbWFpbiBtZW5la2FuIHRvbWJvbCBzcGFjZQogICAgICAgICAgIFVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBnYW1lUHJvY2Vzc2VkKQogICAgICAgICAgICAgICAtLSBNZW1hc3Rpa2FuIGlucHV0IGJ1a2FuIHVudHVrIFVJIGF0YXUgbGFpbm55YQogICAgICAgICAgICAgICBpZiBub3QgZ2FtZVByb2Nlc3NlZCBhbmQgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuS2V5Ym9hcmQgYW5kIGlucHV0LktleUNvZGUgPT0gRW51bS5LZXlDb2RlLlNwYWNlIHRoZW4KICAgICAgICAgICAgICAgICAgIGlmIF9HLmluZmluanVtcCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgLS0gTWVuZ2FrdGlma2FuIEluZmluaXRlIEp1bXAKICAgICAgICAgICAgICAgICAgICAgICBodW1hbm9pZDpDaGFuZ2VTdGF0ZShFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkp1bXBpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkgLS0gTWVudW5nZ3Ugc2VkaWtpdCBzZWJlbHVtIGtlbWJhbGkga2Uga29uZGlzaSBkdWR1awogICAgICAgICAgICAgICAgICAgICAgIGh1bWFub2lkOkNoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkKQogICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgIGVuZCkKICAgICAgIGVuZAoKICAgICAgIC0tIE1lbnVuZ2d1IGthcmFrdGVyIHBlbWFpbiBzaWFwIGF0YXUgZGlyZXNwYXduCiAgICAgICBsb2NhbCBwbHIgPSBnYW1lOkdldFNlcnZpY2UoJ1BsYXllcnMnKS5Mb2NhbFBsYXllcgogICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxyLkNoYXJhY3RlciBvciBwbHIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICBzZXR1cEluZmluaXRlSnVtcChjaGFyYWN0ZXIpCgogICAgICAgLS0gTWVudW5nZ3UgcmVzcGF3biBkYW4gbWVuZ2F0dXIgdWxhbmcgSW5maW5pdGUgSnVtcAogICAgICAgcGxyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24obmV3Q2hhcmFjdGVyKQogICAgICAgICAgIHNldHVwSW5maW5pdGVKdW1wKG5ld0NoYXJhY3RlcikKICAgICAgIGVuZCkKCiAgICAgICAtLSBNZW5naXJpbSBub3RpZmlrYXNpIHNhYXQgSW5maW5pdGUgSnVtcCBkaWFrdGlma2FuIGF0YXUgZGltYXRpa2FuCiAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgZ2FtZS5TdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgICAgIFRpdGxlID0gIkhvbWllcyBIdWIiLAogICAgICAgICAgICAgICBUZXh0ID0gIkluZmluaXRlIEp1bXAgQWN0aXZhdGVkISIsCiAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgIH0pCiAgICAgICAgICAgUmF5ZmllbGQ6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiV0FSTklORyIsCiAgICAgICAgICAgIENvbnRlbnQgPSAiRmFsbCBEYW1hZ2Ugc3RpbGwgYWZmZWN0ZWQgaWYgdSB1c2luZyBJbmZpbml0ZSBKdW1wISIsCiAgICAgICAgICAgIER1cmF0aW9uID0gMTAsCiAgICAgICAgICAgIEltYWdlID0gIm1lc3NhZ2Utc3F1YXJlLXdhcm5pbmciLAogICAgICAgICAgICB9KQogICAgICAgZWxzZQogICAgICAgICAgIGdhbWUuU3RhcnRlckd1aTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgICAgICAgICBUaXRsZSA9ICJIb21pZXMgSHViIiwKICAgICAgICAgICAgICAgVGV4dCA9ICJJbmZpbml0ZSBKdW1wIERlYWN0aXZhdGVkISIsCiAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgIH0pCiAgICAgICBlbmQKICAgZW5kLAp9KQoKLS0gRmxhc2hsaWdodCBUb2dnbGUKbG9jYWwgZmxhc2hsaWdodFRvZ2dsZSA9IE1haW5UYWI6Q3JlYXRlVG9nZ2xlKHsKICAgTmFtZSA9ICJGbGFzaGxpZ2h0IiwKICAgQ3VycmVudFZhbHVlID0gZmFsc2UsCiAgIEZsYWcgPSAiRmxhc2hsaWdodEZsYWciLAogICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKCiAgICAgICAtLSBQYXN0aWthbiBIdW1hbm9pZFJvb3RQYXJ0IGFkYSBzZWJlbHVtIG1lbGFuanV0a2FuCiAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIsIDUpICAtLSBNZW51bmdndSBzZWxhbWEgNSBkZXRpawoKICAgICAgIC0tIEppa2EgSHVtYW5vaWRSb290UGFydCB0aWRhayBkaXRlbXVrYW4sIGhlbnRpa2FuIGVrc2VrdXNpCiAgICAgICBpZiBub3QgaHVtYW5vaWRSb290UGFydCB0aGVuCiAgICAgICAgICAgZ2FtZS5TdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgICAgIFRpdGxlID0gIkVycm9yIiwKICAgICAgICAgICAgICAgVGV4dCA9ICJIdW1hbm9pZFJvb3RQYXJ0IG5vdCBmb3VuZCEiLAogICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICB9KQogICAgICAgICAgIHJldHVybgogICAgICAgZW5kCgogICAgICAgLS0gRnVuZ3NpIHVudHVrIG1lbmFtYmFoIFNwb3RsaWdodAogICAgICAgbG9jYWwgZnVuY3Rpb24gYWRkU3BvdExpZ2h0QXJvdW5kUGxheWVyKCkKICAgICAgICAgICAtLSBNZW1idWF0IFNwb3RMaWdodAogICAgICAgICAgIGxvY2FsIGxpZ2h0ID0gSW5zdGFuY2UubmV3KCJTcG90TGlnaHQiKQogICAgICAgICAgIGxpZ2h0LlBhcmVudCA9IGh1bWFub2lkUm9vdFBhcnQgIC0tIExhbXB1IGRpdGVtcGF0a2FuIGRpIEh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICBsaWdodC5SYW5nZSA9IDMwICAtLSBKYXJhayBjYWhheWEKICAgICAgICAgICBsaWdodC5CcmlnaHRuZXNzID0gNyAgLS0gS2VjZXJhaGFuIGNhaGF5YQogICAgICAgICAgIGxpZ2h0LkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkgIC0tIFdhcm5hIGNhaGF5YSBwdXRpaAogICAgICAgICAgIGxpZ2h0LkVuYWJsZWQgPSB0cnVlICAtLSBMYW1wdSBtZW55YWxhCiAgICAgICAgICAgbGlnaHQuQW5nbGUgPSA0NSAgLS0gU3VkdXQgY2FoYXlhIHlhbmcgbGViaWggdGVyZm9rdXMKICAgICAgICAgICBsaWdodC5EaXJlY3Rpb24gPSBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZS5Mb29rVmVjdG9yICAtLSBBcmFoIGNhaGF5YSBtZW5naWt1dGkgYXJhaCBwYW5kYW5nIGthcmFrdGVyCgogICAgICAgICAgIC0tIE1lbmFtYmFoa2FuIHNlZGlraXQgb2Zmc2V0IHVudHVrIHBvc2lzaSBsYW1wdQogICAgICAgICAgIGxvY2FsIG9mZnNldCA9IEluc3RhbmNlLm5ldygiQXR0YWNobWVudCIpCiAgICAgICAgICAgb2Zmc2V0LlBhcmVudCA9IGh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICBvZmZzZXQuUG9zaXRpb24gPSBWZWN0b3IzLm5ldygwLCAzLCAwKSAgLS0gTWVuZW1wYXRrYW4gc2VkaWtpdCBkaSBhdGFzIGthcmFrdGVyCiAgICAgICAgICAgbGlnaHQuQXR0YWNobWVudDAgPSBvZmZzZXQKICAgICAgIGVuZAoKICAgICAgIC0tIE5vdGlmaWthc2kgc2FhdCB0b2dnbGUgZGlha3RpZmthbiBhdGF1IGRpbm9uYWt0aWZrYW4KICAgICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICAgICBnYW1lLlN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICAgICAgICAgVGl0bGUgPSAiSG9taWVzIEh1YiIsCiAgICAgICAgICAgICAgIFRleHQgPSAiRmxhc2hsaWdodCBBY3RpdmF0ZWQhIiwKICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgfSkKCiAgICAgICAgICAgLS0gTWVuYW1iYWhrYW4gbGFtcHUgc2FhdCB0b2dnbGUgZGlueWFsYWthbgogICAgICAgICAgIGFkZFNwb3RMaWdodEFyb3VuZFBsYXllcigpCiAgICAgICBlbHNlCiAgICAgICAgICAgZ2FtZS5TdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgICAgIFRpdGxlID0gIkhvbWllcyBIdWIiLAogICAgICAgICAgICAgICBUZXh0ID0gIkZsYXNobGlnaHQgRGVhY3RpdmF0ZWQhIiwKICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgfSkKCiAgICAgICAgICAgLS0gTWVuZ2hlbnRpa2FuIFNwb3RsaWdodCBzYWF0IHRvZ2dsZSBkaW1hdGlrYW4KICAgICAgICAgICBsb2NhbCBleGlzdGluZ0xpZ2h0ID0gaHVtYW5vaWRSb290UGFydDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIlNwb3RMaWdodCIpCiAgICAgICAgICAgaWYgZXhpc3RpbmdMaWdodCB0aGVuCiAgICAgICAgICAgICAgIGV4aXN0aW5nTGlnaHQuRW5hYmxlZCA9IGZhbHNlICAtLSBNZW1hdGlrYW4gbGFtcHUKICAgICAgICAgICAgICAgZXhpc3RpbmdMaWdodDpEZXN0cm95KCkgIC0tIE1lbmdoYXB1cyBsYW1wdSBkYXJpIHBlcm1haW5hbgogICAgICAgICAgIGVuZAogICAgICAgZW5kCiAgIGVuZCwKfSkKCi0tIFdhbGtTcGVlZCBTbGlkZXIKbG9jYWwgU2xpZGVyID0gTWFpblRhYjpDcmVhdGVTbGlkZXIoewogICBOYW1lID0gIldhbGtTcGVlZCIsCiAgIFJhbmdlID0gezEsIDM1MH0sCiAgIEluY3JlbWVudCA9IDEsCiAgIFN1ZmZpeCA9ICJTcGVlZCIsCiAgIEN1cnJlbnRWYWx1ZSA9IDE2LAogICBGbGFnID0gInNsaWRlcndzIiwKICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLldhbGtTcGVlZCA9IChWYWx1ZSkKICAgZW5kLAp9KQoKLS0gSnVtcFBvd2VyIFNsaWRlcgpsb2NhbCBTbGlkZXIgPSBNYWluVGFiOkNyZWF0ZVNsaWRlcih7CiAgIE5hbWUgPSAiSnVtcFBvd2VyIChObyBGYWxsIERhbWFnZSkiLAogICBSYW5nZSA9IHsxLCAzNTB9LAogICBJbmNyZW1lbnQgPSAxLAogICBTdWZmaXggPSAiUG93ZXIiLAogICBDdXJyZW50VmFsdWUgPSAxNiwKICAgRmxhZyA9ICJzbGlkZXJqcCIsCiAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5KdW1wUG93ZXIgPSAoVmFsdWUpCiAgIGVuZCwKfSkKCi0tIEdyYXZpdHkgU2xpZGVyCmxvY2FsIFNsaWRlciA9IE1haW5UYWI6Q3JlYXRlU2xpZGVyKHsKICAgTmFtZSA9ICJHcmF2aXR5IChObyBGYWxsIERhbWFnZSkiLAogICBSYW5nZSA9IHsxLCA1MDB9LAogICBJbmNyZW1lbnQgPSAxLAogICBTdWZmaXggPSAiR3Jhdml0eSIsCiAgIEN1cnJlbnRWYWx1ZSA9IGdhbWUuV29ya3NwYWNlLkdyYXZpdHksCiAgIEZsYWcgPSAic2xpZGVyZ3Jhdml0eSIsCiAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2FtZS5Xb3Jrc3BhY2UuR3Jhdml0eSA9IFZhbHVlCiAgIGVuZCwKfSkKCi0tIE90aGVyIFNlY3Rpb24gdW50dWsgZml0dXIgbGFpbm55YQpsb2NhbCBPdGhlclNlY3Rpb24gPSBNYWluVGFiOkNyZWF0ZVNlY3Rpb24oIk90aGVyIikKCmxvY2FsIEZyZWV6ZUNhbWVyYVRvZ2dsZSA9IE1haW5UYWI6Q3JlYXRlVG9nZ2xlKHsKICAgIE5hbWUgPSAiRnJlZXplIENhbWVyYSIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiRnJlZXplQ2FtZXJhRmxhZyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNhbWVyYSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKCiAgICAgICAgLS0gRnVuZ3NpIHVudHVrIG1lbWJla3VrYW4gZ2VyYWthbiBrYW1lcmEgKGZyZWV6ZSBjYW1lcmEpCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gc2V0RnJlZXplQ2FtZXJhKGVuYWJsZSkKICAgICAgICAgICAgaWYgZW5hYmxlIHRoZW4KICAgICAgICAgICAgICAgIC0tIE1lbWJ1YXQga2FtZXJhIHRpZGFrIGJlcmdlcmFrIGF0YXUgYmVycHV0YXIgc2VjYXJhIG90b21hdGlzCiAgICAgICAgICAgICAgICBjYW1lcmEuRmllbGRPZlZpZXcgPSA3MCAgLS0gTWVuZ2F0dXIgRk9WIGtlIG5pbGFpIHN0YW5kYXIKICAgICAgICAgICAgICAgIGNhbWVyYS5DYW1lcmFUeXBlID0gRW51bS5DYW1lcmFUeXBlLlNjcmlwdGFibGUgIC0tIE1lbm9uYWt0aWZrYW4gcGVyZ2VyYWthbiBvdG9tYXRpcyBrYW1lcmEKICAgICAgICAgICAgICAgIGNhbWVyYS5DRnJhbWUgPSBjYW1lcmEuQ0ZyYW1lICAtLSBNZW5qYWdhIHBvc2lzaSBkYW4gcm90YXNpIHRldGFwIHN0YWJpbAoKICAgICAgICAgICAgICAgIC0tIExvb3AgdW50dWsgbWVuamFnYSBhZ2FyIGthbWVyYSB0ZXRhcCBzdGFiaWwgcGFkYSBwb3Npc2kgZGFuIG9yaWVudGFzaSB5YW5nIHNhbWEKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHVwZGF0ZUNhbWVyYSgpCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgZW5hYmxlIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIE1lbmphZ2EgQ0ZyYW1lIGFnYXIgdGV0YXAgc2FtYSwgbWVtYXN0aWthbiBrYW1lcmEgdGlkYWsgYmVyZ2VyYWsKICAgICAgICAgICAgICAgICAgICAgICAgY2FtZXJhLkNGcmFtZSA9IGNhbWVyYS5DRnJhbWUKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjEpICAtLSBNZW1wZXJiYXJ1aSBwb3Npc2kga2FtZXJhIHNldGlhcCAwLjEgZGV0aWsKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIC0tIE11bGFpIGxvb3AgdW50dWsgbWVtYXN0aWthbiBrYW1lcmEgdGV0YXAgc3RhYmlsCiAgICAgICAgICAgICAgICBjb3JvdXRpbmUud3JhcCh1cGRhdGVDYW1lcmEpKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLS0gTm90aWZpa2FzaSB1bnR1ayBwZW1haW4KICAgICAgICAgICAgICAgIGdhbWUuU3RhcnRlckd1aTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkZyZWV6ZSBDYW1lcmEiLAogICAgICAgICAgICAgICAgICAgIFRleHQgPSAiQ2FtZXJhIG1vdmVtZW50IGlzIGludGVycnVwdGVkLiIsCiAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAtLSBNZW5nZW1iYWxpa2FuIHBlbmdhdHVyYW4ga2FtZXJhIGtlIGRlZmF1bHQKICAgICAgICAgICAgICAgIGNhbWVyYS5DYW1lcmFUeXBlID0gRW51bS5DYW1lcmFUeXBlLkN1c3RvbQogICAgICAgICAgICAgICAgY2FtZXJhLkZpZWxkT2ZWaWV3ID0gNzAgIC0tIFJlc2V0IEZPViBrZSBuaWxhaSBzZW11bGEKCiAgICAgICAgICAgICAgICAtLSBOb3RpZmlrYXNpIHVudHVrIHBlbWFpbgogICAgICAgICAgICAgICAgZ2FtZS5TdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiVW5GcmVlemUgQ2FtZXJhIiwKICAgICAgICAgICAgICAgICAgICBUZXh0ID0gIkNhbWVyYSBtb3ZlbWVudCBpcyBmcmVlLiIsCiAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgLS0gVGVyYXBrYW4gZnJlZXplIGNhbWVyYSBiZXJkYXNhcmthbiBuaWxhaSB0b2dnbGUKICAgICAgICBzZXRGcmVlemVDYW1lcmEoVmFsdWUpCiAgICBlbmQsCn0pCgotLSBJbmZvIFRhYiB1bnR1ayBmaXR1ciBsYWlubnlhCmxvY2FsIEluZm9UYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCLwn6SUIiwgbmlsKQoKLS0gTWVuYW1iYWhrYW4gbGFiZWwgdW50dWsgbWVuYW1waWxrYW4gaW5mb3JtYXNpIHBlbWJ1YXQgZGFuIHZlcnNpCmxvY2FsIGluZm9MYWJlbCA9IEluZm9UYWI6Q3JlYXRlTGFiZWwoIkhvbWllcyBIdWIgYnkgeXVnaWVvb2giKSAgLS0gR2FudGkgW1lvdXIgTmFtZV0gZGVuZ2FuIG5hbWEgcGVtYnVhdApsb2NhbCB2ZXJzaW9uTGFiZWwgPSBJbmZvVGFiOkNyZWF0ZUxhYmVsKCJWZXJzaW9uOiAxLjAiKSAgLS0gR2FudGkgMS4wIGRlbmdhbiB2ZXJzaSBzYWF0IGluaQoKLS0gQXR1ciBwb3Npc2kgYXRhdSBsYXlvdXQgamlrYSBwZXJsdQppbmZvTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMjApICAtLSBTZXN1YWlrYW4gcG9zaXNpIGxhYmVsIHBlcnRhbWEKdmVyc2lvbkxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDQwKSAgLS0gU2VzdWFpa2FuIHBvc2lzaSBsYWJlbCBrZWR1YQoKZWxzZQogICAgLS0gSmlrYSBnYW1lIElEIHRpZGFrIGNvY29rLCB0YW1waWxrYW4gbm90aWZpa2FzaSBhdGF1IGJlcmhlbnRpCiAgICBnYW1lLlN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICBUaXRsZSA9ICJHYW1lIENoZWNrIiwKICAgICAgICBUZXh0ID0gIldST05HIEdBTUUhIiwKICAgICAgICBEdXJhdGlvbiA9IDUKICAgIH0pCiAgICByZXR1cm4gIC0tIE1lbnl1ZGFoaSBza3JpcCBqaWthIGdhbWUgSUQgdGlkYWsgY29jb2sKZW5kCg
